#!/usr/bin/env bash
# Script that configures a new Ubuntu machine to meet the specified requirements

# Update package list
sudo apt-get update -y

# Install Nginx
sudo apt-get install -y nginx

# Create a custom HTML page with "Hello World!" content
echo "Hello World!" | sudo tee /var/www/html/index.html

# Configure the 301 redirect for /redirect_me
sudo sed -i '/server {/a \\tlocation /redirect_me {\n\t\treturn 301 https://www.blog.temitayo.com;\n\t}' /etc/nginx/sites-available/default

# Ensure Nginx is listening on port 80 (this is default, but making sure)
sudo sed -i 's/listen 80 default_server;/listen 80;/g' /etc/nginx/sites-available/default
sudo sed -i 's/listen \[::\]:80 default_server;/listen \[::\]:80;/g' /etc/nginx/sites-available/default

# Reload Nginx to apply configuration changes (without using systemctl)
sudo nginx -s reload
